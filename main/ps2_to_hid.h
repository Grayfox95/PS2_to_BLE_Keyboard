#include <inttypes.h>
#include "hid_dev.h"

#define MAX_SCANCODE 0xFC+1
#define MAX_EXT_SCANCODE 0xFD+1

extern const uint8_t scancode_to_hid[MAX_SCANCODE] = {
    [0x00] = 0x01,	            // Keyboard Overrun Error
    [0xFC] = 0x02,              // Keyboard POST Fail
    [0x1C] = HID_KEY_A,
    [0x32] = HID_KEY_B,
    [0x21] = HID_KEY_C,
    [0x23] = HID_KEY_D,
    [0x24] = HID_KEY_E,
    [0x2B] = HID_KEY_F,
    [0x34] = HID_KEY_G,
    [0x33] = HID_KEY_H,
    [0x43] = HID_KEY_I,
    [0x3B] = HID_KEY_J,
    [0x42] = HID_KEY_K,
    [0x4B] = HID_KEY_L,
    [0x3A] = HID_KEY_M,
    [0x31] = HID_KEY_N,
    [0x44] = HID_KEY_O,
    [0x4D] = HID_KEY_P,
    [0x15] = HID_KEY_Q,
    [0x2D] = HID_KEY_R,
    [0x1B] = HID_KEY_S,
    [0x2C] = HID_KEY_T,
    [0x3C] = HID_KEY_U,
    [0x2A] = HID_KEY_V,
    [0x1D] = HID_KEY_W,
    [0x22] = HID_KEY_X,
    [0x35] = HID_KEY_Y,
    [0x1A] = HID_KEY_Z,
    [0x16] = HID_KEY_1,
    [0x1E] = HID_KEY_2,
    [0x26] = HID_KEY_3,
    [0x25] = HID_KEY_4,
    [0x2E] = HID_KEY_5,
    [0x36] = HID_KEY_6, 
    [0x3D] = HID_KEY_7,
    [0x3E] = HID_KEY_8,
    [0x46] = HID_KEY_9,
    [0x45] = HID_KEY_0,
    [0x5A] = HID_KEY_RETURN,
    [0x76] = HID_KEY_ESCAPE,
    [0x66] = HID_KEY_DELETE,
    [0x0D] = HID_KEY_TAB,
    [0x29] = HID_KEY_SPACEBAR,
    [0x4E] = HID_KEY_MINUS,
    [0x55] = HID_KEY_EQUAL,
    [0x54] = HID_KEY_LEFT_BRKT,
    [0x5B] = HID_KEY_RIGHT_BRKT,
    [0x5D] = HID_KEY_BACK_SLASH,
    [0x4C] = HID_KEY_SEMI_COLON,
    [0x52] = HID_KEY_SGL_QUOTE,
    [0x0E] = HID_KEY_GRV_ACCENT,
    [0x41] = HID_KEY_COMMA,
    [0x49] = HID_KEY_DOT,
    [0x4A] = HID_KEY_FWD_SLASH,
    [0x58] = HID_KEY_CAPS_LOCK,
    [0x05] = HID_KEY_F1,
    [0x06] = HID_KEY_F2,
    [0x04] = HID_KEY_F3,
    [0x0C] = HID_KEY_F4,
    [0x03] = HID_KEY_F5,
    [0x0B] = HID_KEY_F6,
    [0x83] = HID_KEY_F7,
    [0x0A] = HID_KEY_F8,
    [0x01] = HID_KEY_F9,
    [0x09] = HID_KEY_F10,
    [0x78] = HID_KEY_F11,
    [0x07] = HID_KEY_F12,
    [0x7E] = HID_KEY_SCROLL_LOCK,
    [0x77] = HID_KEY_NUM_LOCK,
    [0x7C] = HID_KEY_MULTIPLY,
    [0x7B] = HID_KEY_SUBTRACT,
    [0x79] = HID_KEY_ADD,
    [0x69] = HID_KEYPAD_1,
    [0x72] = HID_KEYPAD_2,
    [0x7A] = HID_KEYPAD_3,
    [0x6B] = HID_KEYPAD_4,
    [0x73] = HID_KEYPAD_5,
    [0x74] = HID_KEYPAD_6,
    [0x6C] = HID_KEYPAD_7,
    [0x75] = HID_KEYPAD_8,
    [0x7D] = HID_KEYPAD_9,
    [0x70] = HID_KEYPAD_0,
    [0x71] = HID_KEYPAD_DOT,
    [0x61] = 0,
    [0x0F] = 0,
    [0x08] = 0,
    [0x10] = 0,
    [0x18] = 0,
    [0x20] = 0,
    [0x28] = 0,
    [0x30] = 0,
    [0x38] = 0,
    [0x40] = 0,
    [0x48] = 0,
    [0x50] = 0,
    [0x57] = 0,
    [0x5F] = 0,
    [0x6D] = 0,
    [0x51] = 0,
    [0x13] = 0,
    [0x6A] = 0,
    [0x64] = 0,
    [0x67] = 0,
    [0xF2] = 0,
    [0xF1] = 0,
    [0x63] = 0,
    [0x62] = 0,
    [0x14] = HID_KEY_LEFT_CTRL,
    [0x12] = HID_KEY_LEFT_SHIFT,
    [0x11] = HID_KEY_LEFT_ALT,
    [0x59] = HID_KEY_RIGHT_SHIFT,    
};

extern const uint16_t ext_scancode_to_hid[MAX_EXT_SCANCODE] = {
    [0x37]= HID_CONSUMER_POWER,
    [0x3F]= HID_CONSUMER_SLEEP,
    [0x5E]= HID_CONSUMER_RESET,
    [0x7C]= HID_KEY_PRNT_SCREEN,
    [0x70]= HID_KEY_INSERT,
    [0x6C]= HID_KEY_HOME,
    [0x7D]= HID_KEY_PAGE_UP,
    [0x71]= HID_KEY_DELETE_FWD,
    [0x69]= HID_KEY_END,
    [0x7A]= HID_KEY_PAGE_DOWN,
    [0x74]= HID_KEY_RIGHT_ARROW,
    [0x6B]= HID_KEY_LEFT_ARROW,
    [0x72]= HID_KEY_DOWN_ARROW,
    [0x75]= HID_KEY_UP_ARROW,
    [0x4A]= HID_KEY_DIVIDE,
    [0x5A]= HID_KEY_ENTER,
    [0x2F]= 0x65, // App
    //[0x37]= 0x66, // Keyboard power
    [0x1F]= HID_KEY_LEFT_GUI,
    [0x14]= HID_KEY_RIGHT_CTRL,
    [0x11]= HID_KEY_RIGHT_ALT,
    [0x27]= HID_KEY_RIGHT_GUI,
    [0x4D]= HID_CONSUMER_SCAN_NEXT_TRK,
    [0x15]= HID_CONSUMER_SCAN_PREV_TRK,
    [0x3B]= HID_CONSUMER_PLAY_PAUSE,  
    [0x34]= HID_CONSUMER_STOP,
    [0x23]= HID_CONSUMER_MUTE,
    [0x32]= HID_CONSUMER_VOLUME_UP,
    [0x21]= HID_CONSUMER_VOLUME_DOWN,
    [0x50]= 0x0183, // Media Player
    [0x48]= 0x184,  // Email
    [0x2B]= 0x192,  // Calculator
    [0x40]= 0x194,  // My Computer
    [0x10]= 0x0221, // Search
    [0x3A]= 0x0223, // Browser/Home
    [0x38]= 0x0224, // Back
    [0x30]= 0x0225, // Forward
    [0x28]= 0x0226, // Stop
    [0x20]= 0x0227, //Refresh
    [0x18]= 0x022A,  // Bookmarks
    [0x4B]= 0x40,
    [0x3A]= 0x8A
};


